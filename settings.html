<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#FFC0CB">
    <title>✨ Settings - Poopy Adventure ⚙️</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              royal: {
                50: '#fff5f7',
                100: '#ffe4ec',
                200: '#ffc9db',
                300: '#ffa6c5',
                400: '#ff7aab',
                500: '#ff4d94',
                600: '#f72585',
                700: '#e01875',
                800: '#b91465',
                900: '#8b0f4e'
              },
              pastel: {
                pink: '#FFB6D9',
                purple: '#D4A5FF',
                blue: '#A5D8FF',
                mint: '#B8F2E6',
                peach: '#FFD6BA',
                lavender: '#E8D5FF'
              },
              champagne: {
                50: '#fdfbf7',
                100: '#F7E7CE',
                200: '#f0d9b5',
                300: '#e8ca9d'
              }
            }
          }
        }
      }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&family=Quicksand:wght@400;500;600;700&display=swap');
        
        * {
            font-family: 'Poppins', 'Quicksand', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            overscroll-behavior: none;
            -webkit-overflow-scrolling: touch;
            overflow-x: hidden;
            background: linear-gradient(135deg, #FFE5F1 0%, #FFF0F8 25%, #F0E6FF 50%, #FFE5F1 75%, #FFF5F7 100%);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
        }
        
        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(5deg); }
        }
        
        @keyframes sparkle {
            0%, 100% { opacity: 0.4; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.2); }
        }
        
        @keyframes wiggle {
            0%, 100% { transform: rotate(-3deg); }
            50% { transform: rotate(3deg); }
        }
        
        .float-animation {
            animation: float 3s ease-in-out infinite;
        }
        
        .sparkle-animation {
            animation: sparkle 2s ease-in-out infinite;
        }
        
        .wiggle-hover:hover {
            animation: wiggle 0.5s ease-in-out infinite;
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 182, 217, 0.3);
            box-shadow: 0 8px 32px rgba(255, 105, 180, 0.15);
        }
        
        .safe-top {
            padding-top: max(16px, env(safe-area-inset-top));
        }
        
        .safe-bottom {
            padding-bottom: max(16px, env(safe-area-inset-bottom));
        }
        
        ::-webkit-scrollbar {
            display: none;
        }
        
        html {
            scroll-behavior: smooth;
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        
        .btn-press:active {
            transform: scale(0.96);
        }
        
        .btn-press {
            transition: transform 0.1s ease, box-shadow 0.1s ease;
        }

        /* Toggle switch */
        .toggle-label {
            position: relative;
            transition: background-color 0.3s;
        }
        
        .toggle-label::after {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 28px;
            height: 28px;
            background-color: white;
            border-radius: 50%;
            transition: transform 0.3s;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .toggle-checkbox:checked + .toggle-label {
            background-color: #4169E1;
        }
        
        .toggle-checkbox:checked + .toggle-label::after {
            transform: translateX(24px);
        }
        
        .toggle-checkbox:disabled + .toggle-label {
            cursor: not-allowed;
            opacity: 0.5;
        }
    </style>
</head>
<body class="bg-gradient-to-b from-gray-50 to-gray-100 min-h-screen">

    <!-- Fixed Mobile Header -->
    <header class="sticky top-0 z-50 bg-royal-600 text-white shadow-lg safe-top">
        <div class="px-4 py-4 flex items-center justify-between">
            <a href="mobile-index.html" class="btn-press text-white">
                <i class="fa-solid fa-arrow-left text-xl"></i>
            </a>
            <h1 class="text-xl font-bold">Settings</h1>
            <div class="w-6"></div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="px-4 pt-4 pb-24">

        <!-- Data Management Section -->
        <div class="bg-white rounded-2xl p-5 shadow-md mb-4">
            <h2 class="text-lg font-bold text-royal-800 mb-4">
                <i class="fa-solid fa-database mr-2"></i>Data Management
            </h2>
            
            <div class="space-y-3">
                <!-- Export Data -->
                <button onclick="exportAllData()" class="btn-press w-full flex items-center justify-between p-4 bg-royal-50 rounded-xl hover:bg-royal-100 transition-colors">
                    <div class="flex items-center gap-3">
                        <i class="fa-solid fa-download text-royal-600 text-xl"></i>
                        <div class="text-left">
                            <div class="font-semibold text-gray-800">Export Data</div>
                            <div class="text-xs text-gray-500">Download all entries as JSON</div>
                        </div>
                    </div>
                    <i class="fa-solid fa-chevron-right text-gray-400"></i>
                </button>

                <!-- Import Data -->
                <label class="btn-press w-full flex items-center justify-between p-4 bg-royal-50 rounded-xl hover:bg-royal-100 transition-colors cursor-pointer">
                    <div class="flex items-center gap-3">
                        <i class="fa-solid fa-upload text-royal-600 text-xl"></i>
                        <div class="text-left">
                            <div class="font-semibold text-gray-800">Import Data</div>
                            <div class="text-xs text-gray-500">Restore from backup file</div>
                        </div>
                    </div>
                    <i class="fa-solid fa-chevron-right text-gray-400"></i>
                    <input type="file" id="import-file" accept=".json" onchange="importData(this)" class="hidden">
                </label>

                <!-- Data Stats -->
                <div class="p-4 bg-gray-50 rounded-xl">
                    <div class="flex items-center justify-between mb-2">
                        <span class="text-sm text-gray-600">Total Entries</span>
                        <span id="total-entries" class="text-lg font-bold text-royal-600">0</span>
                    </div>
                    <div class="flex items-center justify-between mb-2">
                        <span class="text-sm text-gray-600">Data Size</span>
                        <span id="data-size" class="text-lg font-bold text-royal-600">0 KB</span>
                    </div>
                    <div class="flex items-center justify-between">
                        <span class="text-sm text-gray-600">First Entry</span>
                        <span id="first-entry" class="text-sm font-semibold text-gray-700">N/A</span>
                    </div>
                </div>

                <!-- Clear All Data -->
                <button onclick="confirmClearData()" class="btn-press w-full flex items-center justify-between p-4 bg-red-50 rounded-xl hover:bg-red-100 transition-colors">
                    <div class="flex items-center gap-3">
                        <i class="fa-solid fa-trash text-red-600 text-xl"></i>
                        <div class="text-left">
                            <div class="font-semibold text-red-700">Clear All Data</div>
                            <div class="text-xs text-red-500">Permanently delete all entries</div>
                        </div>
                    </div>
                    <i class="fa-solid fa-chevron-right text-gray-400"></i>
                </button>
            </div>
        </div>

        <!-- Preferences Section -->
        <div class="bg-white rounded-2xl p-5 shadow-md mb-4">
            <h2 class="text-lg font-bold text-royal-800 mb-4">
                <i class="fa-solid fa-sliders mr-2"></i>Preferences
            </h2>
            
            <div class="space-y-4">
                <!-- Dark Mode Toggle -->
                <div class="flex items-center justify-between p-4 bg-gray-50 rounded-xl opacity-50">
                    <div class="flex items-center gap-3">
                        <i class="fa-solid fa-moon text-gray-500 text-xl"></i>
                        <div>
                            <div class="font-semibold text-gray-600">Dark Mode</div>
                            <div class="text-xs text-gray-500">Coming soon</div>
                        </div>
                    </div>
                    <div class="relative">
                        <input type="checkbox" id="dark-mode" disabled class="sr-only toggle-checkbox">
                        <label for="dark-mode" class="toggle-label block w-14 h-8 bg-gray-300 rounded-full shadow-inner"></label>
                    </div>
                </div>

                <!-- Notifications Toggle -->
                <div class="flex items-center justify-between p-4 bg-gray-50 rounded-xl opacity-50">
                    <div class="flex items-center gap-3">
                        <i class="fa-solid fa-bell text-gray-500 text-xl"></i>
                        <div>
                            <div class="font-semibold text-gray-600">Daily Reminders</div>
                            <div class="text-xs text-gray-500">For mobile app version</div>
                        </div>
                    </div>
                    <div class="relative">
                        <input type="checkbox" id="notifications" disabled class="sr-only toggle-checkbox">
                        <label for="notifications" class="toggle-label block w-14 h-8 bg-gray-300 rounded-full shadow-inner"></label>
                    </div>
                </div>

                <!-- Auto-backup Toggle -->
                <div class="flex items-center justify-between p-4 bg-gray-50 rounded-xl">
                    <div class="flex items-center gap-3">
                        <i class="fa-solid fa-cloud-arrow-up text-royal-600 text-xl"></i>
                        <div>
                            <div class="font-semibold text-gray-800">Auto Backup</div>
                            <div class="text-xs text-gray-500">Weekly automatic backup</div>
                        </div>
                    </div>
                    <div class="relative">
                        <input type="checkbox" id="auto-backup" onchange="toggleAutoBackup(this)" class="sr-only toggle-checkbox">
                        <label for="auto-backup" class="toggle-label block w-14 h-8 bg-gray-300 rounded-full shadow-inner cursor-pointer"></label>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bristol Scale Reference -->
        <div class="bg-white rounded-2xl p-5 shadow-md mb-4">
            <h2 class="text-lg font-bold text-royal-800 mb-4">
                <i class="fa-solid fa-book-medical mr-2"></i>Bristol Stool Scale Guide
            </h2>
            
            <button onclick="toggleBristolGuide()" class="btn-press w-full flex items-center justify-between p-4 bg-royal-50 rounded-xl hover:bg-royal-100 transition-colors">
                <div class="flex items-center gap-3">
                    <i class="fa-solid fa-circle-info text-royal-600 text-xl"></i>
                    <div class="text-left">
                        <div class="font-semibold text-gray-800">View Scale Details</div>
                        <div class="text-xs text-gray-500">Learn about Types 1-7</div>
                    </div>
                </div>
                <i id="guide-arrow" class="fa-solid fa-chevron-down text-gray-400 transition-transform"></i>
            </button>

            <!-- Bristol Guide Content (Hidden by default) -->
            <div id="bristol-guide" class="hidden mt-4 space-y-3">
                <div class="p-4 bg-red-50 rounded-xl border-l-4 border-red-500">
                    <div class="font-bold text-red-800 mb-1">Type 1 - Separate Hard Lumps</div>
                    <div class="text-sm text-gray-600">Like nuts. Hard to pass. Indicates constipation.</div>
                </div>
                <div class="p-4 bg-orange-50 rounded-xl border-l-4 border-orange-500">
                    <div class="font-bold text-orange-800 mb-1">Type 2 - Lumpy & Sausage-like</div>
                    <div class="text-sm text-gray-600">Still difficult. Mild constipation.</div>
                </div>
                <div class="p-4 bg-yellow-50 rounded-xl border-l-4 border-yellow-500">
                    <div class="font-bold text-yellow-800 mb-1">Type 3 - Sausage with Cracks</div>
                    <div class="text-sm text-gray-600">Normal but on dry side.</div>
                </div>
                <div class="p-4 bg-green-50 rounded-xl border-l-4 border-green-500">
                    <div class="font-bold text-green-800 mb-1">Type 4 - Smooth & Soft (IDEAL)</div>
                    <div class="text-sm text-gray-600">Like a sausage/snake. Easy to pass. Perfect!</div>
                </div>
                <div class="p-4 bg-blue-50 rounded-xl border-l-4 border-blue-500">
                    <div class="font-bold text-blue-800 mb-1">Type 5 - Soft Blobs</div>
                    <div class="text-sm text-gray-600">Clear edges. Still normal. May lack fiber.</div>
                </div>
                <div class="p-4 bg-indigo-50 rounded-xl border-l-4 border-indigo-500">
                    <div class="font-bold text-indigo-800 mb-1">Type 6 - Mushy Consistency</div>
                    <div class="text-sm text-gray-600">Fluffy pieces. Mild diarrhea.</div>
                </div>
                <div class="p-4 bg-purple-50 rounded-xl border-l-4 border-purple-500">
                    <div class="font-bold text-purple-800 mb-1">Type 7 - Liquid Consistency</div>
                    <div class="text-sm text-gray-600">Watery. No solid pieces. Severe diarrhea.</div>
                </div>

                <div class="p-4 bg-royal-50 rounded-xl mt-4">
                    <div class="text-sm text-gray-700">
                        <strong class="text-royal-800">💡 Health Tip:</strong> Types 3-4 are ideal. Types 1-2 suggest constipation (drink more water, eat fiber). Types 6-7 suggest diarrhea (stay hydrated, see doctor if persistent).
                    </div>
                </div>
            </div>
        </div>

        <!-- Help & Support -->
        <div class="bg-white rounded-2xl p-5 shadow-md mb-4">
            <h2 class="text-lg font-bold text-royal-800 mb-4">
                <i class="fa-solid fa-circle-question mr-2"></i>Help & Support
            </h2>
            
            <div class="space-y-3">
                <button onclick="showFAQ()" class="btn-press w-full flex items-center justify-between p-4 bg-gray-50 rounded-xl hover:bg-gray-100 transition-colors">
                    <div class="flex items-center gap-3">
                        <i class="fa-solid fa-circle-question text-royal-600 text-xl"></i>
                        <div class="text-left">
                            <div class="font-semibold text-gray-800">FAQ</div>
                            <div class="text-xs text-gray-500">Frequently asked questions</div>
                        </div>
                    </div>
                    <i class="fa-solid fa-chevron-right text-gray-400"></i>
                </button>

                <button onclick="shareApp()" class="btn-press w-full flex items-center justify-between p-4 bg-gray-50 rounded-xl hover:bg-gray-100 transition-colors">
                    <div class="flex items-center gap-3">
                        <i class="fa-solid fa-share-nodes text-royal-600 text-xl"></i>
                        <div class="text-left">
                            <div class="font-semibold text-gray-800">Share App</div>
                            <div class="text-xs text-gray-500">Recommend to friends</div>
                        </div>
                    </div>
                    <i class="fa-solid fa-chevron-right text-gray-400"></i>
                </button>
            </div>
        </div>

        <!-- About Section -->
        <div class="bg-white rounded-2xl p-5 shadow-md mb-4">
            <h2 class="text-lg font-bold text-royal-800 mb-4">
                <i class="fa-solid fa-circle-info mr-2"></i>About
            </h2>
            
            <div class="text-center py-4">
                <i class="fa-solid fa-toilet text-6xl text-royal-600 mb-4"></i>
                <h3 class="text-xl font-bold text-gray-800 mb-2">Poopy Adventure Tracker</h3>
                <p class="text-sm text-gray-500 mb-4">Version 1.0.0</p>
                <p class="text-sm text-gray-600 mb-4">Track your digestive health adventures with comprehensive bowel movement monitoring.</p>
                
                <div class="bg-royal-50 rounded-xl p-4 text-left">
                    <div class="text-xs text-gray-600 space-y-1">
                        <p><strong>Features:</strong></p>
                        <p>✓ Bristol Stool Scale tracking</p>
                        <p>✓ Comprehensive symptom logging</p>
                        <p>✓ Calendar view & analytics</p>
                        <p>✓ Data export for doctors</p>
                        <p>✓ Privacy-first (local storage only)</p>
                    </div>
                </div>

                <div class="mt-4 text-xs text-gray-400">
                    <p>Made with ❤️ for digestive health adventures</p>
                    <p class="mt-1">© 2025 Poopy Adventure Tracker</p>
                </div>
                
                <!-- Dedicated Credits -->
                <div class="mt-6 glass-card bg-gradient-to-br from-pink-50 via-purple-50 to-pink-50 rounded-2xl p-6 border-2 border-pink-300 relative overflow-hidden">
                    <div class="absolute top-0 right-0 text-8xl opacity-10">💖</div>
                    <div class="absolute bottom-0 left-0 text-6xl opacity-10">🌸</div>
                    <div class="relative z-10">
                        <div class="text-center mb-4">
                            <div class="text-4xl mb-2 sparkle-animation">👑</div>
                            <p class="text-pink-600 font-bold text-lg mb-2">💝 Specially Made For 💝</p>
                            <p class="text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-pink-500 via-purple-500 to-pink-500 mb-2 animate-pulse">
                                Aeri Victoria
                            </p>
                            <p class="text-sm text-gray-600 italic mb-3">
                                This app was created with love exclusively for you ✨
                            </p>
                            <div class="flex justify-center gap-2 text-2xl">
                                <span class="sparkle-animation">✨</span>
                                <span class="float-animation">💕</span>
                                <span class="sparkle-animation" style="animation-delay: 0.5s;">🌸</span>
                                <span class="float-animation" style="animation-delay: 1s;">🦋</span>
                                <span class="sparkle-animation" style="animation-delay: 1.5s;">⭐</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Privacy Notice -->
        <div class="bg-yellow-50 rounded-2xl p-4 shadow-md mb-4 border-l-4 border-yellow-500">
            <div class="flex items-start gap-3">
                <i class="fa-solid fa-shield-halved text-yellow-600 text-xl mt-1"></i>
                <div>
                    <div class="font-bold text-yellow-800 mb-1">Privacy First</div>
                    <div class="text-sm text-gray-700">
                        All your data is stored locally on your device. Nothing is sent to servers. Your health data stays private and under your control.
                    </div>
                </div>
            </div>
        </div>

    </div>

    <script>
        // Update data stats on load
        function updateDataStats() {
            const logs = JSON.parse(localStorage.getItem('poopLogsProV2') || '[]');
            
            // Total entries
            document.getElementById('total-entries').textContent = logs.length;
            
            // Data size
            const dataStr = JSON.stringify(logs);
            const sizeKB = (new Blob([dataStr]).size / 1024).toFixed(2);
            document.getElementById('data-size').textContent = sizeKB + ' KB';
            
            // First entry date
            if (logs.length > 0) {
                const firstLog = logs[logs.length - 1];
                const date = new Date(firstLog.timestamp).toLocaleDateString();
                document.getElementById('first-entry').textContent = date;
            }
        }

        // Export all data
        function exportAllData() {
            const logs = JSON.parse(localStorage.getItem('poopLogsProV2') || '[]');
            
            if (logs.length === 0) {
                alert('No data to export!');
                return;
            }

            const dataStr = JSON.stringify(logs, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `poop-tracker-backup-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);

            // Show success message
            showToast('✅ Data exported successfully!');
        }

        // Import data
        function importData(input) {
            const file = input.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const importedData = JSON.parse(e.target.result);
                    
                    if (!Array.isArray(importedData)) {
                        throw new Error('Invalid data format');
                    }

                    // Confirm before overwriting
                    if (confirm(`Import ${importedData.length} entries? This will merge with existing data.`)) {
                        const existingLogs = JSON.parse(localStorage.getItem('poopLogsProV2') || '[]');
                        const mergedLogs = [...existingLogs, ...importedData];
                        
                        // Remove duplicates by ID
                        const uniqueLogs = mergedLogs.filter((log, index, self) =>
                            index === self.findIndex(l => l.id === log.id)
                        );
                        
                        localStorage.setItem('poopLogsProV2', JSON.stringify(uniqueLogs));
                        updateDataStats();
                        showToast('✅ Data imported successfully!');
                    }
                } catch (error) {
                    alert('❌ Error importing data. Please check the file format.');
                    console.error(error);
                }
            };
            reader.readAsText(file);
            
            // Reset file input
            input.value = '';
        }

        // Clear all data
        function confirmClearData() {
            const logs = JSON.parse(localStorage.getItem('poopLogsProV2') || '[]');
            
            if (logs.length === 0) {
                alert('No data to clear!');
                return;
            }

            if (confirm(`⚠️ Delete all ${logs.length} entries? This cannot be undone!\n\nTip: Export your data first as a backup.`)) {
                if (confirm('Are you absolutely sure? This is permanent!')) {
                    localStorage.removeItem('poopLogsProV2');
                    updateDataStats();
                    showToast('🗑️ All data cleared');
                }
            }
        }

        // Toggle Bristol guide
        function toggleBristolGuide() {
            const guide = document.getElementById('bristol-guide');
            const arrow = document.getElementById('guide-arrow');
            
            if (guide.classList.contains('hidden')) {
                guide.classList.remove('hidden');
                arrow.classList.add('rotate-180');
            } else {
                guide.classList.add('hidden');
                arrow.classList.remove('rotate-180');
            }
        }

        // Toggle auto backup
        function toggleAutoBackup(checkbox) {
            if (checkbox.checked) {
                localStorage.setItem('autoBackup', 'true');
                showToast('✅ Auto backup enabled');
            } else {
                localStorage.setItem('autoBackup', 'false');
                showToast('Auto backup disabled');
            }
        }

        // Show FAQ
        function showFAQ() {
            alert(`📖 Frequently Asked Questions

Q: Is my data private?
A: Yes! All data is stored locally on your device. Nothing is sent to servers.

Q: Can I share my data with my doctor?
A: Yes! Use "Export Data" to download a JSON file you can share.

Q: What's the ideal Bristol type?
A: Types 3-4 are considered ideal. Type 4 is the gold standard!

Q: How often should I track?
A: Track every bowel movement for the most accurate health insights.

Q: Can I use this on multiple devices?
A: Export from one device and import to another to sync data.`);
        }

        // Share app
        function shareApp() {
            if (navigator.share) {
                navigator.share({
                    title: 'Poopy Adventure Tracker',
                    text: 'Join the adventure! Track your digestive health with this comprehensive bowel movement tracker!',
                    url: window.location.href
                }).catch(() => {});
            } else {
                alert('📱 Share this app with friends!\n\nPoopy Adventure Tracker helps monitor digestive health with the Bristol Stool Scale.');
            }
        }

        // Show toast notification
        function showToast(message) {
            const toast = document.createElement('div');
            toast.className = 'fixed bottom-24 left-1/2 -translate-x-1/2 bg-gray-800 text-white px-6 py-3 rounded-full shadow-lg z-50';
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.opacity = '0';
                toast.style.transition = 'opacity 0.3s';
                setTimeout(() => toast.remove(), 300);
            }, 2000);
        }

        // Load saved preferences
        function loadPreferences() {
            const autoBackup = localStorage.getItem('autoBackup') === 'true';
            document.getElementById('auto-backup').checked = autoBackup;
        }

        // Initialize
        updateDataStats();
        loadPreferences();
    </script>
</body>
</html>
